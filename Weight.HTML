<!doctype html>
<html lang="ar" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Weight</title>

  <a id="link1" href="index.html">Discount & Sale Price</a>

  <style>
    body {
      font-family: Arial;
      padding: 0;
      margin: 0;
      background:#f0f0f5;
      display:flex;
      align-items:flex-start;
    }

    .table-container {
      width:50%;
      padding:10px;
      box-sizing:border-box;
    }

    table {
      width:100%;
      border-collapse:collapse;
      background:white;
      direction:ltr;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      font-size:14px;
      table-layout:fixed;
    }

    th, td {
      border:1px solid #ccc;
      padding:4px;
      text-align:center;
      min-width:50px;
      overflow:hidden;
      white-space:nowrap;
      position: relative;
    }

    th { background:#444; color:white; font-weight:bold; }

    td[contenteditable="true"] { background:#fff9c4; font-weight:bold; }
    td.readonly { background:#f9f9f9; }

    .c2 { background:#ffcccc; }
    .c3 { background:#cce5ff; }
    .c4 { background:#ccffcc; }
    .c5 { background:#ffe0b3; }
    .c6 { background:#e0ccff; }

    tbody tr:nth-child(odd) { background:#fdfdfd; }
    tbody tr:nth-child(even) { background:#f6f6f6; }

    .price { background:#fff59d; font-weight:bold; border:1px solid #ffd700; }

    .controls { display:flex; gap:5px; margin-bottom:5px; }
    .controls input { font-size:14px; padding:4px; width:60px; }

    button {
      padding:6px 14px;
      font-size:15px;
      border:none;
      border-radius:6px;
      cursor:pointer;
    }

    #copyAll { background:#4c8bf5; color:white; }
    #copyShort { background:#34a853; color:white; }
  </style>
</head>

<body>

<div class="table-container">
  <h2 style="text-align:left; color:#333;">Weight</h2>

  <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø³Ø® -->
  <div style="display:flex; gap:5px; margin-bottom:5px;">
    <button id="copyAll">ğŸ“‹ Copy All</button>
    <button id="copyShort">ğŸ“‹ Copy with Short Code</button>
  </div>

  <div class="controls">
    <input id="hdr3" type="number" value="0" placeholder="Ø¹Ù†ÙˆØ§Ù† 3">
    <input id="hdr4" type="number" value="500" placeholder="Ø¹Ù†ÙˆØ§Ù† 4">
    <input id="hdr5" type="number" value="800" placeholder="Ø¹Ù†ÙˆØ§Ù† 5">
    <input id="hdr6" type="number" value="1000" placeholder="Ø¹Ù†ÙˆØ§Ù† 6">
  </div>

  <table>
    <thead>
      <tr>
        <th id="th1">Real Price</th>
        <th id="th2">External Price</th>
        <th id="th3">0 g</th>
        <th id="th4">500 g</th>
        <th id="th5">800 g</th>
        <th id="th6">1000 g</th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>
</div>

<script>
const ROWS = 300;
const tbody = document.getElementById("tbody");

function fmt(n){ return Math.round(n*1e6)/1e6; }

// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ
for(let i=0;i<ROWS;i++){
  const tr = document.createElement("tr");

  const price = document.createElement("td");
  price.contentEditable = "true";
  price.className = "price";

  const c2 = document.createElement("td"); c2.className = "c2 readonly";
  const c3 = document.createElement("td"); c3.textContent = "0"; c3.className = "c3 readonly";
  const c4 = document.createElement("td"); c4.className = "c4 readonly";
  const c5 = document.createElement("td"); c5.className = "c5 readonly";
  const c6 = document.createElement("td"); c6.className = "c6 readonly";

  tr.appendChild(price);
  tr.appendChild(c2);
  tr.appendChild(c3);
  tr.appendChild(c4);
  tr.appendChild(c5);
  tr.appendChild(c6);

  tbody.appendChild(tr);
}

// Ø¹Ù†Ø§ØµØ± Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø¤ÙˆØ³
const hdr3 = document.getElementById("hdr3");
const hdr4 = document.getElementById("hdr4");
const hdr5 = document.getElementById("hdr5");
const hdr6 = document.getElementById("hdr6");

function updateHeaders(){
  document.getElementById("th3").textContent = hdr3.value + " g";
  document.getElementById("th4").textContent = hdr4.value + " g";
  document.getElementById("th5").textContent = hdr5.value + " g";
  document.getElementById("th6").textContent = hdr6.value + " g";
}

function recompute(){
  const h3 = parseFloat(hdr3.value) || 0;
  const v4 = parseFloat(hdr4.value) || 0;
  const v5 = parseFloat(hdr5.value) || 0;
  const v6 = parseFloat(hdr6.value) || 0;

  tbody.querySelectorAll("tr").forEach(tr=>{
    const price = parseFloat(tr.querySelector(".price").textContent) || 0;

    tr.querySelector(".c2").textContent = fmt((h3/1000)*price);
    tr.querySelector(".c4").textContent = fmt((v4/1000)*price - (h3/1000)*price);
    tr.querySelector(".c5").textContent = fmt((v5/1000)*price - (h3/1000)*price);
    tr.querySelector(".c6").textContent = fmt((v6/1000)*price - (h3/1000)*price);
  });
}

[hdr3, hdr4, hdr5, hdr6].forEach(h=>{
  h.addEventListener("input",()=>{ updateHeaders(); recompute(); });
});

// **ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ØªØ¹Ø¯ÙŠÙ„ Ø£ÙŠ Ø³Ø¹Ø±**
tbody.querySelectorAll(".price").forEach(td=>{
  td.addEventListener("input", recompute);
});

// Ù„ØµÙ‚ Ù…Ù† Excel
tbody.addEventListener("paste", e=>{
  const text = (e.clipboardData || window.clipboardData).getData("text");
  if(text.includes("\n")){
    e.preventDefault();
    const rows = text.trim().split("\n");

    let startCell = e.target;
    let tr = startCell.parentElement;
    let rowIndex = [...tbody.children].indexOf(tr);

    rows.forEach((value, i)=>{
      if(rowIndex + i >= ROWS) return;

      const targetRow = tbody.children[rowIndex + i];
      const firstCell = targetRow.children[0];

      firstCell.textContent = value.trim();
    });

    recompute();
  }
});

// Enter ÙŠÙ†Ø²Ù„ Ù„Ù„Ø³Ø·Ø± Ø§Ù„ØªØ§Ù„ÙŠ
tbody.addEventListener("keydown", e=>{
  if(e.key === "Enter"){
    e.preventDefault();
    let cell = e.target;
    if(cell.tagName !== "TD") return;

    let row = cell.parentElement;
    let next = row.nextElementSibling;
    if(next){
      next.children[0].focus();
    }
  }
});

// Ø²Ø± Ù†Ø³Ø® ÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø¯ÙˆÙ† Ø§Ù„ØµÙÙˆÙ Ø§Ù„ÙØ§Ø±ØºØ© Ø£Ùˆ Ø§Ù„ØµÙÙˆÙ Ø§Ù„ØªÙŠ Ù‚ÙŠÙ…Ù‡Ø§ ØµÙØ±
document.getElementById("copyAll").onclick = ()=>{
  let text = "";
  tbody.querySelectorAll("tr").forEach(tr=>{
    let row = [];
    Array.from(tr.children).forEach(td=>{
      let val = td.textContent.trim();
      if(val !== "" && val !== "0") row.push(val);
    });
    if(row.length) text += row.join("\t") + "\n";
  });

  navigator.clipboard.writeText(text.trim());
};

// Ø²Ø± Ø§Ù„Ù†Ø³Ø® Ø¨Ø§Ù„Ù€ Short Code Ù…Ø¹ ÙØ±Ø§ØºØ§Øª Ù…Ø­Ø¯Ø¯Ø© ÙˆØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
document.getElementById("copyShort").onclick = ()=>{
  let text = "";
  tbody.querySelectorAll("tr").forEach(tr=>{
    const col3 = tr.children[2].textContent.trim();
    const col4 = tr.children[3].textContent.trim();
    const col5 = tr.children[4].textContent.trim();
    const col6 = tr.children[5].textContent.trim();

    // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„ØµÙÙˆÙ Ø§Ù„ØªÙŠ ÙƒÙ„ Ù‚ÙŠÙ…Ù‡Ø§ ÙØ§Ø±ØºØ© Ø£Ùˆ ØµÙØ±
    if((col3 !== "" && col3 !== "0") || (col4 !== "" && col4 !== "0") || 
       (col5 !== "" && col5 !== "0") || (col6 !== "" && col6 !== "0")){

      text +="ShortCode\t\t\t\t\t\t\t" + col3 + col3 + "\t\t" + col4 + "\t\t" + col5 + "\t\t" + col6 + "\n";
    }
  });

  navigator.clipboard.writeText(text.trim());
};
</script>

</body>
</html>
